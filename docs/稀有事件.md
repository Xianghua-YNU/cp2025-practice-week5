

# 稀有事件模拟项目

## 项目概述

本项目将实现罕见事件的模拟和分析。您将使用Python模拟不公平硬币的翻转过程，研究泊松分布的特性，并分析等待时间的统计规律。

## 学习目标

完成本项目后，您将能够：
1. 理解和实现泊松分布
2. 模拟和分析罕见事件
3. 使用NumPy进行高效的数值计算
4. 掌握统计分布的可视化技术

## 理论背景

考虑一个不公平的硬币，其正面概率为0.08。对于这样的罕见事件，其概率分布遵循泊松分布：

$$
\mathcal{P}(\ell)=\frac{e^{-8}\cdot 8^{\ell}}{\ell!}
$$

其中$\ell$表示在100次试验中出现正面的次数。

## 项目要求

### 1. 泊松分布实现 (30分)
- 实现泊松分布概率质量函数
- 使用scipy.special中的阶乘函数
- 注意处理数值溢出问题
- 绘制泊松分布的概率质量函数图

### 2. 硬币翻转模拟 (35分)
a. 基础模拟
   - 实现单次试验（100次翻转）
   - 记录正面出现的次数
   - 使用合适的数据结构存储结果

b. 统计分析
   - 进行1000次试验
   - 创建正面次数的频率直方图
   - 将实验结果与理论分布对比
   - 扩展到1,000,000次试验并分析差异

### 3. 等待时间分析 (35分)
a. 数据生成
   - 生成长序列的硬币翻转结果
   - 使用np.nonzero找出正面位置
   - 计算连续正面之间的等待时间

b. 统计可视化
   - 绘制等待时间的频率分布
   - 创建半对数和对数-对数图
   - 分析分布的数学特性
   - 计算平均等待时间

## 技术要求

### 所需库
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.special import factorial
```

### 关键函数
1. calculate_poisson_pmf(l_values, lambda_val=8) ：计算泊松分布概率
2. simulate_coin_flips(N, n=100, p=0.08) ：模拟硬币翻转
3. analyze_waiting_times(num_flips, p=0.08) ：分析等待时间
4. plot_distribution_comparison(experimental, theoretical) ：比较分布
## 提交要求
1. 源代码文件 ( rare_events.py )
2. 实验报告，包含：
   - 实现方法说明
   - 分布分析结果
   - 等待时间分析
   - 理论与实验的对比
   - 遇到的问题和解决方案
## 评分标准
1. 代码质量 (30%)
   
   - 代码结构和组织
   - 数值计算的稳定性
   - 错误处理
2. 功能实现 (40%)
   
   - 泊松分布计算的准确性
   - 模拟的正确性
   - 统计分析的完整性
3. 报告质量 (30%)
   
   - 结果分析的深度
   - 理论解释的准确性
   - 文档的完整性
## 参考资料
1. Kinder & Nelson,《A student's guide to Python for physical modeling》2021年第二版第七章7.3
## 截止日期
- 提交：第5周周六 06:00
## 注意事项
1. 注意处理大数计算时的溢出问题
2. 确保统计样本量足够大
3. 合理使用NumPy的向量化操作
4. 独立完成，避免抄袭